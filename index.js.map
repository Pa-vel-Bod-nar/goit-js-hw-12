{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\r\nconst BASE_URL = 'https://pixabay.com/api/';\r\nconst API_KEY = '49651388-bf829c1018596f8ebf90706c1';\r\n\r\nlet page = 1; \r\n\r\n\r\nasync function getImagesByQuery(query, page = 1) {\r\n    const response = await axios.get(BASE_URL, {\r\n        params: {\r\n            key: API_KEY,\r\n            q: query,\r\n            image_type: 'photo',\r\n            orientation: 'horizontal',\r\n            safesearch: true,\r\n            page,\r\n            per_page: 15, \r\n        },\r\n    });\r\n   return response.data\r\n}\r\n\r\nexport { getImagesByQuery };\r\n\r\n","import SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\nlet lightbox;\r\nconst gallery = document.querySelector('.gallery');\r\n\r\nexport function createGallery(images) {\r\n    \r\n    const markup = images\r\n        .map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => {\r\n            return `\r\n            <a class=\"gallery__item\" href=\"${largeImageURL}\">\r\n             <img class=\"gallery__image\" src=\"${webformatURL}\" alt=\"${tags}\" />\r\n               <div class=\"info\">\r\n              <p class=\"info-item\"><b>Likes:</b> ${likes}</p>\r\n              <p class=\"info-item\"><b>Views:</b> ${views}</p>\r\n              <p class=\"info-item\"><b>Comments:</b> ${comments}</p>\r\n              <p class=\"info-item\"><b>Downloads:</b> ${downloads}</p>\r\n            </div>\r\n        </a>`;\r\n        \r\n        })\r\n\r\n    .join('');\r\n\r\n    gallery.insertAdjacentHTML('beforeend', markup);\r\n\r\n    if (!lightbox) {\r\n        lightbox = new SimpleLightbox('.gallery a', {\r\n          captionsData: 'alt',\r\n          captionDelay: 250,\r\n        });\r\n      } else {\r\n        lightbox.refresh(); // 🔄 обновить при повторной вставке\r\n      }\r\n};\r\n\r\n\r\n\r\nexport function clearGallery() {\r\n    return gallery.innerHTML = '';\r\n};\r\n\r\nexport function showLoader() {\r\n    document.querySelector('.loader').classList.remove('hidden');\r\n};\r\n\r\nexport function hideLoader(){\r\n    document.querySelector('.loader').classList.add('hidden');\r\n};\r\n\r\nexport function showLoadMoreButton(){\r\n    document.querySelector('.load-more').classList.remove('load-more-hidden');\r\n};\r\n\r\nexport function hideLoadMoreButton(){\r\n    document.querySelector('.load-more').classList.add('load-more-hidden');\r\n};\r\n\r\n\r\n","import './css/styles.css';\r\nimport iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\nimport {getImagesByQuery} from './js/pixabay-api.js';\r\nimport {\r\n    createGallery, \r\n    clearGallery, \r\n    showLoader, \r\n    hideLoader, \r\n    showLoadMoreButton,\r\n    hideLoadMoreButton,\r\n} from './js/render-functions.js';\r\n\r\n\r\n\r\nconst form = document.querySelector('.form');\r\nconst loadMoreBtn = document.querySelector('.load-more');\r\n\r\nhideLoadMoreButton();\r\n\r\nlet currentQuery = '';\r\nlet currentPage = 1;\r\n\r\nconst perPage = 15;\r\n\r\n\r\nform.addEventListener('submit', async event =>{\r\n    event.preventDefault();\r\n\r\n    const query = event.currentTarget.elements.searchQuery.value.trim();\r\n\r\n    if (!query){\r\n        iziToast.warning({\r\n            title: 'Attention',\r\n            message: 'Input yuor request!',\r\n            position: 'topRight',\r\n          });\r\n          return;\r\n    }\r\n\r\n    try{\r\n        showLoader(); \r\n        hideLoadMoreButton();\r\n        clearGallery();\r\n\r\n        currentQuery = query;\r\n        currentPage = 1;\r\n\r\n        const data = await getImagesByQuery(currentQuery, currentPage);\r\n        \r\n\r\n        if (data.hits.length === 0) {\r\n            iziToast.info({\r\n              title: 'There is nothing was found',\r\n              message: 'Try another request',\r\n              position: 'topRight',\r\n            });\r\n            hideLoadMoreButton();\r\n            return;\r\n        }\r\n      \r\n        createGallery(data.hits);\r\n\r\n        const totalPages = Math.ceil(data.totalHits / perPage);\r\n        if (data.hits.length < perPage || currentPage >= totalPages) {\r\n          hideLoadMoreButton();\r\n        } else {\r\n          showLoadMoreButton();\r\n        }\r\n\r\n        \r\n    \r\n    } catch (error) {\r\n        iziToast.error({\r\n            title: 'Error',\r\n            message: 'Something went wrong!',\r\n            position: 'topRight',\r\n          });\r\n    } finally {\r\n        hideLoader();\r\n    }\r\n});\r\n\r\nloadMoreBtn.addEventListener('click', async () => {\r\n    currentPage +=1;\r\n\r\n    try{\r\n        showLoader();\r\n        \r\n        const data = await getImagesByQuery(currentQuery, currentPage);\r\n\r\n        createGallery(data.hits);\r\n\r\n        const totalPages = Math.ceil(data.totalHits / perPage);\r\n\r\n        if (currentPage >= totalPages) {\r\n            hideLoadMoreButton();\r\n        \r\n\r\n        iziToast.info({\r\n            title: 'End of collection',\r\n            message: \"We're sorry, but you've reached the end of search results.\",\r\n            position: 'topRight',\r\n          });\r\n        }\r\n\r\n        const firstGalleryItem = document.querySelector('.gallery .gallery__item');\r\n    if (firstGalleryItem) {\r\n      const { height: cardHeight } = firstGalleryItem.getBoundingClientRect();\r\n      window.scrollBy({\r\n        top: cardHeight * 2,\r\n        behavior: 'smooth',\r\n      });\r\n    }\r\n   \r\n    } catch (error){\r\n        iziToast.error({\r\n            title: 'Error',\r\n            message: 'Failed to load more images.',\r\n            position: 'topRight',\r\n          });\r\n    } finally{\r\n        hideLoader();\r\n    }\r\n});"],"names":["BASE_URL","API_KEY","getImagesByQuery","query","page","axios","lightbox","gallery","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","loadMoreBtn","currentQuery","currentPage","perPage","event","iziToast","data","totalPages","firstGalleryItem","cardHeight"],"mappings":"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"}